// CVE-2021-44228 (Log4Shell) Process Groups Detection
// This query identifies process groups that may be affected by the Log4Shell vulnerability
// based on Java processes using vulnerable Log4j versions (2.0-2.14.x)

fetch dt.entity.process_group
| fieldsAdd softwareTechnologies
| expand softwareTechnologies
| filter contains(softwareTechnologies, "LOG4J")
| filter contains(softwareTechnologies, "version:2.0") or 
        contains(softwareTechnologies, "version:2.1") or 
        contains(softwareTechnologies, "version:2.2") or 
        contains(softwareTechnologies, "version:2.3") or 
        contains(softwareTechnologies, "version:2.4") or 
        contains(softwareTechnologies, "version:2.5") or 
        contains(softwareTechnologies, "version:2.6") or 
        contains(softwareTechnologies, "version:2.7") or 
        contains(softwareTechnologies, "version:2.8") or 
        contains(softwareTechnologies, "version:2.9") or 
        contains(softwareTechnologies, "version:2.10") or 
        contains(softwareTechnologies, "version:2.11") or 
        contains(softwareTechnologies, "version:2.12") or 
        contains(softwareTechnologies, "version:2.13") or 
        contains(softwareTechnologies, "version:2.14")
| fieldsAdd entity.name, id
| sort entity.name